---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "passwordsafe Provider"
subcategory: ""
description: |-
  A Terraform integration that enables using Password Safe secrets management capabilities with Terraform
---

# passwordsafe Provider

The Password Safe Terraform provider is a Terraform integration for Password Safe which enables using Password Safe secrets management capabilities with Terraform.

Terraform configuration files can be configured to retrieve secrets from Password Safe.

Permissions for access to secrets in Password Safe can be granted to specific accounts within BeyondInsight.

<!-- schema generated by tfplugindocs -->

## Schema

### Required

- `api_account_name` (String) The user name for the api request to the Password Safe instance. For use when authenticating with an api key.
- `api_key` (String) The api key for making requests to the Password Safe instance. For use when authenticating to Password Safe, if API key is not set, then client credentials method would be used instead:
- `client_id` (String) API OAuth Client ID.
- `client_secret` (String) API OAuth Client Secret.
- `url` (String) The URL for the Password Safe instance from which to request a secret.

### Optional

- `client_certificate_name` (String) The name of the Client Certificate for use when authenticating with an api key using a Client Certificate.
- `client_certificate_password` (String) The password associated with the Client Certificate. For use when authenticating with an api key using a Client Certificate
- `client_certificates_folder_path` (String) The path to the Client Certificate associated with the Password Safe instance for use when authenticating with an api key using a Client Certificate.
- `verify_ca` (Boolean) Indicates whether to verify the certificate authority on the Password Safe instance. For use when authenticating to Password Safe.
- `api_version` (String) The recommended version is 3.1. If no version is specified, the default API version 3.0 will be use.

## Usage

```terraform
terraform {
  required_providers {
    passwordsafe = {
      source = "beyondtrust/passwordsafe"
      version = "1.0.1"
    }
  }
}
```

`Add terraform.tfvars`

```json
api_key                         = "<your_api_key>"
client_id                       = "<your_client_id>"
client_secret                   = "<your_client_secret>"
url                             = "https://example.com/Beyondtrust/api/public/v3"
api_version                     = "3.1"
api_account_name                = "<your_api_key_user>"
client_certificates_folder_path = "<your_certificate_path>"
client_certificate_name         = "<your_certificate_name>"
client_certificate_password     = "<your_certificate_password>"
```

```terraform
provider "passwordsafe" {
  api_key                         = var.api_key
  client_id                       = var.client_id
  client_secret                   = var.client_secret
  url                             = var.url
  api_version                     = var.api_version
  api_account_name                = var.api_account_name
  verify_ca                       = true
  client_certificates_folder_path = var.client_certificates_folder_path
  client_certificate_name         = var.client_certificate_name
  client_certificate_password     = var.client_certificate_password
}
```

### Get secrets and managed account secrets

```terraform
# retrieve a managed account secret
data "passwordsafe_managed_account" "manage_account" {
  system_name = "ServerStandard"
  account_name = "serveruser1"
}

output "manage_account" {
  value = "${data.passwordsafe_managed_account.manage_account.value}"
}

# retrieve a secrets safe credential
data "passwordsafe_secret" "secret_credential" {
  path = "folder1/folder2/folder3/folder4"
  title = "credLevel6"
}

output "secret_credential" {
  value = "${data.passwordsafe_secret.secret_credential.value}"
}

# retrieve a secrets safe file
data "passwordsafe_secret" "secret_file" {
  path = "folder1"
  title = "RootFile"
}

 output "secret_file" {
  value = "${data.passwordsafe_secret.secret_file.value}"
}
```

### Get secrets and managed account secrets using ephemeral resources

```terraform
ephemeral "passwordsafe_managed_acccount_ephemeral" "managed_account" {
  system_name = "system01"
  account_name = "managed_account01"
}

ephemeral "passwordsafe_secret_ephemeral" "secret" {
  path = "oauthgrp"
  title = "ephemeral_secret_title"
}
```

### Create Secrets, folder and safes

There are three types of secrets you can create: credential, text, and file. You need to define the parent folder name. If the parent folder does not exist, you must create it before creating the secret.

```terraform
# create credential secret
resource "passwordsafe_credential_secret" "my_credenial_secret" {
  folder_name = "folder1"
  title = "Credential_Secret_from_Terraform"
  username = "my_user_name"
  password = "password_content"
  owner_type = "User"
  # optional attributes from here on
  description = "my credential secret description"
  owner_id = 1
  notes = "My Notes"
  password_rule_id = 1
  # the API user will be added as the owner by default
  owners {
    owner_id = 1
    owner = "owner"
    email = "user@beyondtrust.com"
  }
  urls {
    id = 1
    credential_id = 1
    url = "https://www.beyondtrust.com/"
  }
}

# create text secret
resource "passwordsafe_text_secret" "my_text_secret" {
  folder_name = "folder1"
  title = "Text_Secret_from_Terraform"
  text = "password_text"
  owner_type = "User"
  # optional attributes from here on
  description = "my text secret description"
  owner_id = 1
  notes = "My notes"
  # the API user will be added as the owner by default
  owners {
    owner_id = 1
    owner = "owner"
    email = "user@beyondtrust.com"
  }
  urls {
    id = 1
    credential_id = 1
    url = "https://www.beyondtrust.com/"
  }
}

# create file secret
resource "passwordsafe_file_secret" "my_file_secret" {
  folder_name = "folder1"
  title = "File_Secret_from_Terraform"
  file_content = file("test_secret.txt")
  file_name = "my_secret.txt"
  owner_type = "User"
  # optional attributes from here on
  description = "my file secret description"
  owner_id = 1
  notes= "My notes"
  # the API user will be added as the owner by default
  owners {
    owner_id = 1
    owner = "owner"
    email = "user@beyondtrust.com"
  }
  urls {
    id = 1
    credential_id = 1
    url = "https://www.beyondtrust.com/"
  }
}
```

### Create Folder

```terraform
# create folder
resource "passwordsafe_folder" "my_folder" {
  parent_folder_name = "folder1"
  name = "my_new_folder_mame"
  # optional attributes from here on
  description = "New Folder Description"
  user_group_id = 1
}
```

### Create Safe

```terraform
# create safe
resource "passwordsafe_safe" "my_safe" {
  name = "my_new_safe_mame"
  description="my_safe_description" #optional
}
```

### Create Managed Account

```terraform
# create managed account
resource "passwordsafe_managed_account" "my_managed_account" {
  system_name = "system_integration_test"
  account_name = "managed_account_Test"
  password = "MyTest101*!"

  # optional attributes from here on
  domain_name                       = "example.com"
  user_principal_name               = "user123@example.com"
  sam_account_name                  = "USER123"
  distinguished_name                = "CN=User123,OU=Users,DC=example,DC=com"
  private_key                       = "/path/to/private/key.pem"
  passphrase                        = "mysecretpassphrase"
  password_fallback_flag            = true
  login_account_flag                = false
  description                       = "This is a test user account"
  password_rule_id                  = 1
  api_enabled                       = true
  release_notification_email        = "notify@example.com"
  change_services_flag              = true
  restart_services_flag             = false
  change_tasks_flag                 = true
  release_duration                  = 30
  max_release_duration              = 90
  isa_release_duration              = 60
  max_concurrent_requests           = 10
  auto_management_flag              = true
  dss_auto_management_flag          = false
  check_password_flag               = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag   = true
  change_frequency_type             = "first"
  change_frequency_days             = 30
  change_time                       = "03:00"
  next_change_date                  = "2025-01-01"
  use_own_credentials               = false
  workgroup_id                      = 2
  change_windows_auto_logon_flag    = true
  change_com_plus_flag              = false
  change_dcom_flag                  = true
  change_scom_flag                  = false
  object_id                         = "12345-abcde-67890"
}
```

### Create Workgroup

```terraform
# create workgroup
resource "passwordsafe_workgroup" "workgroup" {
  name = "workgroup_name"
}
```

### Create Asset using workgroup name

```terraform
# create asset by workgroup name
resource "passwordsafe_asset_by_workgroup_name" "asset_by_workgroup_name" {
  work_group_name  = passwordsafe_workgroup.workgroup.name
  ip_address       = "10.20.30.40"
  asset_name       = "Prod_Server_03"
  dns_name         = "server01.company.com"
  domain_name      = "company.com"
  mac_address      = "00:1A:2B:3C:4D:5E"
  asset_type       = "Windows Server"
  description      = "Production Windows Server hosting critical applications"
  operating_system = "Windows Server 2022"
}
```

### Create Asset using workgroup id

```terraform
# create asset by workgroup name
resource "passwordsafe_asset_by_workgroup_name" "asset_by_workgroup_name" {
  work_group_id    = "28"
  ip_address       = "10.20.30.40"
  asset_name       = "Prod_Server_03"
  dns_name         = "server01.company.com"
  domain_name      = "company.com"
  mac_address      = "00:1A:2B:3C:4D:5E"
  asset_type       = "Windows Server"
  description      = "Production Windows Server hosting critical applications"
  operating_system = "Windows Server 2022"
}
```

### Create Database using asset id

```terraform
# create database by asset id
resource "passwordsafe_database" "database" {
  asset_id            = "1"
  platform_id         = 10
  instance_name       = "primary-db-instance"
  is_default_instance = false
  port                = 5432
  version             = "13.3"
  template            = "standard-template"
}
```

### Create Managed System using asset id

```terraform
# create managed system by asset id / API Version: 3.0
resource "passwordsafe_managed_system_by_asset" "managed_system_by_asset" {
  asset_id                               = "48"
  platform_id                            = 2
  contact_email                          = "admin@example.com"
  description                            = "managed_system_by_asset"
  port                                   = 5432
  timeout                                = 30
  ssh_key_enforcement_mode               = 1
  password_rule_id                       = 0
  dss_key_rule_id                        = 0
  login_account_id                       = 0
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 90
  auto_management_flag                   = false
  functional_account_id                  = 0
  elevation_command                      = "sudo su"
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "last"
  change_frequency_days                  = 30
  change_time                            = "02:00"
}

# create managed system by asset id / API Version: 3.1
resource "passwordsafe_managed_system_by_asset" "managed_system_by_asset" {
  asset_id                               = "48"
  platform_id                            = 2
  contact_email                          = "admin@example.com"
  description                            = "managed_system_by_asset"
  port                                   = 5432
  timeout                                = 30
  ssh_key_enforcement_mode               = 1
  password_rule_id                       = 0
  dss_key_rule_id                        = 0
  login_account_id                       = 0
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 90
  auto_management_flag                   = false
  functional_account_id                  = 0
  elevation_command                      = "sudo su"
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "last"
  change_frequency_days                  = 30
  change_time                            = "02:00"
  remote_client_type                     = "EPM"
}

# create managed system by asset id / API Version: 3.2
resource "passwordsafe_managed_system_by_asset" "managed_system_by_asset" {
  asset_id                               = "48"
  platform_id                            = 2
  contact_email                          = "admin@example.com"
  description                            = "managed_system_by_asset"
  port                                   = 5432
  timeout                                = 30
  ssh_key_enforcement_mode               = 1
  password_rule_id                       = 0
  dss_key_rule_id                        = 0
  login_account_id                       = 0
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 90
  auto_management_flag                   = false
  functional_account_id                  = 0
  elevation_command                      = "sudo su"
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "last"
  change_frequency_days                  = 30
  change_time                            = "02:00"
  remote_client_type                     = "EPM"
  application_host_id                    = 0
  is_application_host                    = false
}

```

### Create Managed System using workgroup id

```terraform
# create managed system by workgroup id / API Version: 3.0
resource "passwordsafe_managed_system_by_workgroup" "managed_system_by_workgroup" {
  workgroup_id                           = "55"
  entity_type_id                         = 1
  host_name                              = "example-host"
  ip_address                             = "222.222.222.22"
  dns_name                               = "example.local"
  instance_name                          = "example-instance"
  is_default_instance                    = true
  template                               = "example-template"
  forest_name                            = "example-forest"
  use_ssl                                = false
  platform_id                            = 2
  netbios_name                           = "EXAMPLE"
  contact_email                          = "admin@example.com"
  description                            = "managed_system_by_workgroup ${random_uuid.generated.result}"
  port                                   = 5432
  timeout                                = 30
  ssh_key_enforcement_mode               = 0
  password_rule_id                       = 0
  dss_key_rule_id                        = 0
  login_account_id                       = 0
  account_name_format                    = 1
  oracle_internet_directory_id           = "example-dir-id"
  oracle_internet_directory_service_name = "example-service"
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 30
  auto_management_flag                   = false
  functional_account_id                  = 0
  elevation_command                      = "sudo su -"
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "last"
  change_frequency_days                  = 7
  change_time                            = "02:00"
  access_url                             = "https://example.com"
}

# create managed system by workgroup id / API Version: 3.1
resource "passwordsafe_managed_system_by_workgroup" "managed_system_by_workgroup" {
  workgroup_id                           = "55"
  entity_type_id                         = 1
  host_name                              = "example-host"
  ip_address                             = "222.222.222.22"
  dns_name                               = "example.local"
  instance_name                          = "example-instance"
  is_default_instance                    = true
  template                               = "example-template"
  forest_name                            = "example-forest"
  use_ssl                                = false
  platform_id                            = 2
  netbios_name                           = "EXAMPLE"
  contact_email                          = "admin@example.com"
  description                            = "managed_system_by_workgroup ${random_uuid.generated.result}"
  port                                   = 5432
  timeout                                = 30
  ssh_key_enforcement_mode               = 0
  password_rule_id                       = 0
  dss_key_rule_id                        = 0
  login_account_id                       = 0
  account_name_format                    = 1
  oracle_internet_directory_id           = "example-dir-id"
  oracle_internet_directory_service_name = "example-service"
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 30
  auto_management_flag                   = false
  functional_account_id                  = 0
  elevation_command                      = "sudo su -"
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "last"
  change_frequency_days                  = 7
  change_time                            = "02:00"
  access_url                             = "https://example.com"
  remote_client_type                     = "ssh"
}

# create managed system by workgroup id / API Version: 3.2
resource "passwordsafe_managed_system_by_workgroup" "managed_system_by_workgroup" {
  workgroup_id                           = "55"
  entity_type_id                         = 1
  host_name                              = "example-host"
  ip_address                             = "222.222.222.22"
  dns_name                               = "example.local"
  instance_name                          = "example-instance"
  is_default_instance                    = true
  template                               = "example-template"
  forest_name                            = "example-forest"
  use_ssl                                = false
  platform_id                            = 2
  netbios_name                           = "EXAMPLE"
  contact_email                          = "admin@example.com"
  description                            = "managed_system_by_workgroup ${random_uuid.generated.result}"
  port                                   = 5432
  timeout                                = 30
  ssh_key_enforcement_mode               = 0
  password_rule_id                       = 0
  dss_key_rule_id                        = 0
  login_account_id                       = 0
  account_name_format                    = 1
  oracle_internet_directory_id           = "example-dir-id"
  oracle_internet_directory_service_name = "example-service"
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 30
  auto_management_flag                   = false
  functional_account_id                  = 0
  elevation_command                      = "sudo su -"
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "last"
  change_frequency_days                  = 7
  change_time                            = "02:00"
  access_url                             = "https://example.com"
  remote_client_type                     = "ssh"
  application_host_id                    = 5001
  is_application_host                    = false
}

# create managed system by workgroup id / API Version: 3.3
resource "passwordsafe_managed_system_by_workgroup" "managed_system_by_workgroup" {
  workgroup_id                           = "55"
  entity_type_id                         = 1
  host_name                              = "example-host"
  ip_address                             = "222.222.222.22"
  dns_name                               = "example.local"
  instance_name                          = "example-instance"
  is_default_instance                    = true
  template                               = "example-template"
  forest_name                            = "example-forest"
  use_ssl                                = false
  platform_id                            = 2
  netbios_name                           = "EXAMPLE"
  contact_email                          = "admin@example.com"
  description                            = "managed_system_by_workgroup ${random_uuid.generated.result}"
  port                                   = 5432
  timeout                                = 30
  ssh_key_enforcement_mode               = 0
  password_rule_id                       = 0
  dss_key_rule_id                        = 0
  login_account_id                       = 0
  account_name_format                    = 1
  oracle_internet_directory_id           = "example-dir-id"
  oracle_internet_directory_service_name = "example-service"
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 30
  auto_management_flag                   = false
  functional_account_id                  = 0
  elevation_command                      = "sudo su -"
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "last"
  change_frequency_days                  = 7
  change_time                            = "02:00"
  access_url                             = "https://example.com"
  remote_client_type                     = "ssh"
  application_host_id                    = 5001
  is_application_host                    = false
}
```

### Create Managed System using database id

```terraform
# create managed system by database id
resource "passwordsafe_managed_system_by_database" "managed_system_by_database" {
  database_id                            = "2"
  contact_email                          = "admin@example.com"
  description                            = "Managed system for example DB"
  timeout                                = 30
  password_rule_id                       = 0
  release_duration                       = 60
  max_release_duration                   = 120
  isa_release_duration                   = 45
  auto_management_flag                   = false
  functional_account_id                  = 0
  check_password_flag                    = true
  change_password_after_any_release_flag = false
  reset_password_on_mismatch_flag        = true
  change_frequency_type                  = "xdays"
  change_frequency_days                  = 15
  change_time                            = "03:00"
}
```
